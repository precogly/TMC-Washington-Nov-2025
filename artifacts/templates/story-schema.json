{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Vulnerability Story Schema",
  "type": "object",
  "required": ["id", "vsg_type", "title", "pattern_type", "mechanism", "narrative", "key_factors", "impact_analysis", "emergence_explanation", "generated_at", "model"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^(BVSG|DCVSG|RVSG|TVSG)-\\d{3}$",
      "description": "Unique story identifier (e.g., BVSG-001)"
    },
    "vsg_type": {
      "type": "string",
      "enum": ["behavioral", "dependency_cascade", "resonant", "temporal"],
      "description": "Type of vulnerability story generator that produced this"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "description": "Concise, descriptive name for the vulnerability"
    },
    "pattern_type": {
      "type": "string",
      "description": "Primary classification (varies by VSG type)"
    },
    "mechanism": {
      "type": "string",
      "minLength": 1,
      "description": "2-3 sentences describing the specific dynamics"
    },
    "narrative": {
      "type": "string",
      "minLength": 200,
      "maxLength": 500,
      "description": "200-300 word pre-mortem failure story"
    },
    "key_factors": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "description": "Bulleted list of contributing elements"
    },
    "impact_analysis": {
      "type": "object",
      "description": "Quantified consequences (structure varies by VSG type)"
    },
    "emergence_explanation": {
      "type": "string",
      "minLength": 1,
      "description": "Why this requires multi-agent interaction"
    },
    "generated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of generation"
    },
    "model": {
      "type": "string",
      "description": "Model used for generation (e.g., claude-sonnet-4.5)"
    }
  }
}
